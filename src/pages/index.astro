---
import Layout from "../layouts/Layout.astro";
import RecordingsPlayer from "../components/RecordingsPlayer";
import { getRecordings, getHuffadh, getVenues } from "../lib/db";
import type { RecordingWithDetails, Hafidh, Venue } from "../lib/db";

const recordings = getRecordings.all() as RecordingWithDetails[];
const huffadh = (getHuffadh.all() as Hafidh[]).map((h) => h.name);
const venues = (getVenues.all() as Venue[]).map((v) => v.name);
const cities = [...new Set((getVenues.all() as Venue[]).map((v) => v.city))];
const years = [...new Set(recordings.map((r) => r.hijri_year))].sort(
    (a, b) => b - a,
);
---

<Layout title="Taraweeh Recordings">
    <RecordingsPlayer
        recordings={recordings}
        huffadh={huffadh}
        venues={venues}
        cities={cities}
        years={years}
        client:load
    />
</Layout>
