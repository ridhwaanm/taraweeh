---
import "../../styles/global.css";
import { AdminLayout } from "../../components/admin/AdminLayout";
import { RecordingsTable } from "../../components/admin/RecordingsTable";
import { getAuth } from "../../lib/auth";

export const prerender = false;

const auth = getAuth();

const session = await auth.api.getSession({
    // Correct await usage
    headers: Astro.request.headers,
});

if (!session) {
    return Astro.redirect("/admin/login");
}
---

<!doctype html>
<html lang="en" class="h-full">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Recordings - Admin</title>
    </head>
    <body class="h-full">
        <AdminLayout client:load currentPage="recordings">
            <RecordingsTable client:load />
        </AdminLayout>
    </body>
</html>
